# 钢铁厂仿真数据说明

## 仿真数据概述

钢铁厂监控平台内置了高仿真的钢铁厂全产线时序数据，覆盖高炉、转炉、轧钢等核心生产环节，数据规律贴合真实钢铁厂生产逻辑，支持离线运行，无需对接真实设备/数据库。

## 数据覆盖范围

### 1. 高炉

| 参数名称 | 单位 | 正常范围 | 异常阈值 | 数据规律 |
|---------|------|---------|---------|----------|
| 温度 | ℃ | 1500-1600 | ≥1600 | 缓慢上升趋势，小波动 |
| 压力 | MPa | 2.5-3.0 | ≥3.0 | 与温度相关，小波动 |
| 料位 | % | 20-80 | ≤20 | 周期性变化，加料后恢复 |
| 状态 | - | 运行/待机/故障 | - | 布尔值，默认运行 |

### 2. 转炉

| 参数名称 | 单位 | 正常范围 | 异常阈值 | 数据规律 |
|---------|------|---------|---------|----------|
| 温度 | ℃ | 1580-1620 | ≥1700 | 较大波动，周期性变化 |
| 氧气流量 | m³/h | 60-95 | ≤60 | 周期性变化，吹氧阶段增加 |
| 钢水液位 | % | 20-70 | ≤20 | 缓慢下降，出钢后恢复 |
| 状态 | - | 运行/待机/故障 | - | 布尔值，默认运行 |

### 3. 轧钢机

| 参数名称 | 单位 | 正常范围 | 异常阈值 | 数据规律 |
|---------|------|---------|---------|----------|
| 转速 | m/s | 0.8-1.8 | ≤0.8 或 ≥1.8 | 小波动，稳定运行 |
| 温度 | ℃ | 1430-1500 | ≥1500 | 与转速相关，小波动 |
| 冷却水流量 | L/min | 70-100 | ≤70 | 与温度相关，小波动 |
| 状态 | - | 运行/待机/故障 | - | 布尔值，默认运行 |

## 数据生成逻辑

### 1. 正常生产数据

正常生产数据基于以下逻辑生成：

- **基础值**：每个参数都有一个基础值，代表设备正常运行时的典型值
- **波动范围**：在基础值附近添加随机波动，模拟真实工业环境中的测量误差
- **趋势变化**：根据设备运行状态，添加缓慢的趋势变化，如高炉温度的缓慢上升
- **周期性变化**：某些参数（如料位、氧气流量）会呈现周期性变化，模拟生产工艺的循环过程

### 2. 异常场景数据

异常场景数据基于以下逻辑生成：

- **触发概率**：默认 1% 的概率触发异常场景
- **异常类型**：包括高炉超温、转炉氧气流量过低、轧钢机转速异常等
- **异常程度**：异常值会超出正常范围一定幅度，如高炉温度会突然升高 100℃
- **恢复机制**：异常场景持续一段时间后会自动恢复正常，恢复时间可配置

## 数据文件说明

### 1. 正常生产数据（normal_production_data.json）

包含 24 小时的正常生产数据，按小时记录，可用于：

- 初始化仿真数据源
- 验证数据显示功能
- 测试趋势图表展示

### 2. 异常告警数据（anomaly_alert_data.json）

包含 5 个典型异常场景的详细信息，可用于：

- 测试告警引擎触发
- 验证告警处理流程
- 演示异常场景的影响

## 配置参数

仿真数据的参数可通过 `config/simulation_config.json` 文件进行配置：

### 1. 更新间隔

```json
"updateInterval": 1000
```

数据刷新间隔，单位为毫秒，默认 1000ms（1 秒）。

### 2. 仿真参数

```json
"simulationParams": {
  "blastFurnace": {
    "temperature": {
      "base": 1500.0,
      "range": 50.0,
      "trend": 0.01
    },
    ...
  },
  ...
}
```

- `base`：基础值
- `range`：波动范围
- `trend`：每秒钟的趋势变化值

### 3. 异常场景参数

```json
"anomalyScenarios": {
  "probability": 0.01,
  "scenarios": [
    {
      "id": "blastFurnace.overTemperature",
      "name": "高炉超温",
      "address": "blastFurnace.temperature",
      "type": "high",
      "deviation": 100.0,
      "duration": 300,
      "recoveryTime": 60000
    },
    ...
  ]
}
```

- `probability`：异常触发概率
- `deviation`：异常值偏离正常范围的幅度
- `duration`：异常持续时间（秒）
- `recoveryTime`：异常恢复时间（毫秒）

## 数据加载方式

### 1. 自动加载

仿真数据源会在初始化时自动加载以下数据：

- 默认配置的初始值
- 配置文件中定义的仿真参数
- 异常场景配置

### 2. 手动加载

可通过以下方式手动加载仿真数据：

```cpp
// 加载仿真数据文件
simulatedDataSource->loadSimulationData("data/normal_production_data.json");
```

## 数据使用示例

### 1. 读取数据

```cpp
// 读取单个点位的值
QVariant temperature = simulatedDataSource->readValue("blastFurnace.temperature");

// 读取所有值
QMap<QString, QVariant> allValues = simulatedDataSource->getAllValues();
```

### 2. 写入数据

```cpp
// 写入单个点位的值
simulatedDataSource->writeValue("blastFurnace.status", false);
```

### 3. 监听数据更新

```cpp
// 连接数据更新信号
connect(simulatedDataSource, &SimulatedDataSource::dataUpdated, this, [](const QString &address, const QVariant &value) {
    qDebug() << "数据更新:" << address << "=" << value;
});
```

## 异常场景触发方式

### 1. 自动触发

仿真数据源会根据配置的概率自动触发异常场景，无需手动干预。

### 2. 手动触发

可通过修改仿真数据配置文件中的异常场景参数，调整触发概率和异常类型。

## 数据与告警引擎集成

仿真数据与 Huayan 内置的告警引擎无缝集成：

1. 仿真数据实时更新
2. 告警引擎实时监测数据
3. 当数据超出异常阈值时，触发告警
4. 告警信息显示在界面上，并可播放音效
5. 支持告警确认和处理操作

## 性能优化

为确保仿真数据的性能和稳定性，采取了以下优化措施：

- 数据生成算法轻量化，避免复杂计算
- 数据更新间隔可配置，默认 1 秒
- 支持多线程数据生成（可选）
- 内存使用优化，避免数据堆积

## 扩展建议

如需扩展仿真数据，可考虑以下方向：

1. **增加设备类型**：如增加烧结机、焦化炉等设备的仿真数据
2. **细化工艺参数**：如增加高炉的风量、风温等参数
3. **优化数据模型**：如基于物理模型生成更真实的数据
4. **增加外部接口**：如支持从外部文件或数据库加载仿真数据

---

**本功能基于 Huayan 开箱即用模块实现，仅需配置无需开发**
